<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <title>Football Plotly.Js</title>
</head>
<body>
  <div id="plot"></div>

  <script>

    const prepData = (rawData) => {
    let traces = []

    rawData.map(i => {
      const trace = {
        frameId: i[0],
        PlayersId: Object.keys(i[1]).map(id => `Player ${Math.trunc(id)}`),
        // data: [
        //   {x: Object.values(i[1]).map(x => x[0]),
        //    y: Object.values(i[1]).map(y => y[1])}
        //   ],
        x: Object.values(i[1]).map(x => x[0]),
        y: Object.values(i[1]).map(y => y[1]),
      }
      traces.push(trace)
    })

    return traces
}

    Plotly.d3.json("data1.json", function(err, dataObj) {
      if(err) throw err;
      
    const traces = prepData(Object.entries(dataObj));
    
    const data = [{
      mode: 'markers',
      size: 10,
      text: traces[0].PlayersId,
      x: traces[1].x,
      y: traces[1].y,
    }];
  
    const frames = []

    traces.map(i => {
      const frame = {
        name: i.frameId,
        data: [{
          x: i.x,
          y: i.y,
        }]
      }
      frames.push(frame)
    })

  const steps = [];

  traces.map( i => {
    const step = {
       label: i.frameId,
       method: 'animate',
       args: [[i.frameId], {
         mode: 'immediate',
         frame: {redraw: false, duration: 100},
         transition: {duration: 100}
       }]
     }
     steps.push(step)
  })

    const layout = {
      title: 'ðŸ¦¶âš½',
      showlegend: false,
      hovermode: 'closest',
      height: 640,
      width: 1050,
      updatemenus: [{
      x: 0,
      y: 0,
      yanchor: 'top',
      xanchor: 'left',
      showactive: false,
      direction: 'left',
      type: 'buttons',
      pad: {t: 87, r: 10},
      buttons: [{
        method: 'animate',
        args: [null, {
          mode: 'immediate',
          fromcurrent: true,
          transition: {duration: 200},
          frame: {duration: 100, redraw: false}
        }],
        label: 'Play'
      }, {
          method: 'animate',
          args: [[null], {
            mode: 'immediate',
            transition: {duration: 0},
            frame: {duration: 0, redraw: false}
          }],
          label: 'Pause'
        }]
      }],
      sliders: [{
      pad: {l: 130, t: 55},
      currentvalue: {
        visible: true,
        prefix: 'Time:',
        xanchor: 'right',
        font: {size: 20, color: '#666'}
      },
      steps: steps
    }]
    };

    Plotly.newPlot('plot', 
    { data, 
      layout,
      config: {}, 
      frames})
});
 
  </script>

</body>
</html>
